{
    "bottom": {
        "module": "EmptyBottom",
        "params": {
        }
    },
    "experts": [
        {
            "module": "ConvExpert",
            "params": {
                "conv1_kernel_size": 5,
                "conv1_nb_filters": 10,
                "conv2_kernel_size": 5,
                "conv2_nb_filters": 20,
                "dense1_size": 50,
                "dense2_size": 50
            },
            "instances": 8
        }
    ],
    "gates": [
        {
            "module": "SoftKTreesEnsembleLearnPermutedGate",
            "params": {
                "k": {
                    "optuna_type": "suggest_categorical",
                    "values": [2,4]     
                },
                "input_size": 10,
                "gamma": {
                    "optuna_type": "suggest_categorical",
                    "values": [1e-3, 1e-2, 1e-1, 1, 5, 10]                      
                },
                "use_routing_input": true,
                "use_in_training": true,
                "entropy_reg": {
                    "optuna_type": "suggest_categorical",
                    "values": [1e-4, 5e-4, 1e-3, 5e-3, 1e-2, 5e-2, 1e-1, 5e-1, 1, 5, 10]  
                },
                "z_initializer": null,
                "w_initializer": null,
                "epochs_for_learning_permutation": {
                    "optuna_type": "suggest_categorical",
                    "values": [5]                      
                },
                "noise_factor": {
                    "optuna_type": "suggest_categorical",
                    "values": [0.0, 0.0, 0.0, 0.0, 0.0, 1e-5, 1e-4, 1e-3, 1e-2]  
                },
                "learn_k_permutations": false,
                "perm_entropy_reg": {
                    "optuna_type": "suggest_categorical",
                    "values": [0.0, 0.0, 0.0, 0.0, 0.0]  
                }
            },
            "instances": 2
        }
    ],
    "heads": [
        {
            "module": "DenseMulticlassClassifier",
            "params": {
                "dense1_size": 50,
                "dense2_size": 50,
                "n_labels": 10
            },
            "instances": 2
        }
    ],
    "no_weight_printing": true
}